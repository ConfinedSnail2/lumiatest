<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title id="pageTitle">Property</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="index.css">
</head>
<body>

<div class="container">

  <!-- Property Header -->
  <header class="property-header">
    <h1 id="propertyAddress"></h1>
    <h3 id="propertyCity"></h3>
    <h2 id="propertyPrice"></h2>
    <p id="propertyDescription"></p>
  </header>

  <!-- Photo Gallery -->
  <section id="gallery" class="photo-grid"></section>

  <!-- Videos -->
  <section id="videoSection" style="display:none;">
    <h2>Video</h2>
    <div id="videos"></div>
  </section>

  <!-- Embeds -->
  <section id="embedSection" style="display:none;">
    <h2>Interactive Media</h2>
    <div id="embeds" class="embed-grid"></div>
  </section>

</div>

<script>
fetch('config.json')
  .then(res => res.json())
  .then(config => {

    // Page title
    document.title = config.property.address;

    // Property Info
    document.getElementById('propertyAddress').textContent = config.property.address;
    document.getElementById('propertyCity').textContent = config.property.city;
    document.getElementById('propertyPrice').textContent = config.property.price;
    document.getElementById('propertyDescription').textContent = config.property.description;

    // Photos
    
      let currentIndex = 0;
      let photoArray = [];

      if (config.photos && config.photos.length > 0) {
        const gallery = document.getElementById('gallery');
        photoArray = config.photos;
      
        config.photos.forEach((src, index) => {
          const img = document.createElement('img');
          img.src = src;
          img.loading = "lazy";
          img.addEventListener('click', () => openLightbox(index));
          gallery.appendChild(img);
        });
      }
     
          const lightbox = document.getElementById('lightbox');
          const lightboxImage = document.getElementById('lightboxImage');
          const closeBtn = document.querySelector('.close');
          const prevBtn = document.getElementById('prevBtn');
          const nextBtn = document.getElementById('nextBtn');
              
          function openLightbox(index) {
            currentIndex = index;
            lightbox.style.display = 'flex';
            lightboxImage.src = photoArray[currentIndex];
          }
          
          function closeLightbox() {
            lightbox.style.display = 'none';
          }
          
          function showNext() {
            currentIndex = (currentIndex + 1) % photoArray.length;
            lightboxImage.src = photoArray[currentIndex];
          }
          
          function showPrev() {
            currentIndex = (currentIndex - 1 + photoArray.length) % photoArray.length;
            lightboxImage.src = photoArray[currentIndex];
          }
          
          closeBtn.addEventListener('click', closeLightbox);
          nextBtn.addEventListener('click', showNext);
          prevBtn.addEventListener('click', showPrev);
          
          // Close when clicking outside image
          lightbox.addEventListener('click', (e) => {
            if (e.target === lightbox) {
              closeLightbox();
            }
          });
          
          // Keyboard navigation
          document.addEventListener('keydown', (e) => {
            if (lightbox.style.display === 'flex') {
              if (e.key === 'ArrowRight') showNext();
              if (e.key === 'ArrowLeft') showPrev();
              if (e.key === 'Escape') closeLightbox();
            }
          });
          
      
    
    // Videos
    if (config.videos && config.videos.length > 0) {
      const videoSection = document.getElementById('videoSection');
      const videoContainer = document.getElementById('videos');
      videoSection.style.display = 'block';

      config.videos.forEach(src => {
        const video = document.createElement('video');
        video.src = src;
        video.controls = true;
        video.loading = "lazy";
        videoContainer.appendChild(video);
      });
    }

    // Embeds
    if (config.embeds && config.embeds.length > 0) {
      const embedSection = document.getElementById('embedSection');
      const embedContainer = document.getElementById('embeds');
      embedSection.style.display = 'block';

      config.embeds.forEach(item => {
        const wrapper = document.createElement('div');
        wrapper.classList.add('embed-wrapper');

        const iframe = document.createElement('iframe');
        iframe.src = item.url;
        iframe.allowFullscreen = true;

        wrapper.appendChild(iframe);
        embedContainer.appendChild(wrapper);
      });
    }

  })
  .catch(error => {
    console.error("Config failed to load:", error);
  });
</script>

<!-- Lightbox -->
<div id="lightbox" class="lightbox">
  <span class="close">&times;</span>
  <img class="lightbox-img" id="lightboxImage">
  <div class="lightbox-nav">
    <button id="prevBtn">&#10094;</button>
    <button id="nextBtn">&#10095;</button>
  </div>
</div>


</body>
</html>
